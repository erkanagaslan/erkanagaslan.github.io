---
title: "Finansal Ekonometri - Birinci Uygulama"
author: "DoÃ§.Dr. Erkan AÄŸaslan"
date: "3 Mart 2026 / SalÄ± / 14:00"
output: 
  html_document:
    toc: true                # Ä°Ã§indekiler tablosu oluÅŸturur
    toc_depth: 3             # Ä°Ã§indekilerde 3 seviye derinlik gÃ¶sterir
    number_sections: true    # BÃ¶lÃ¼mleri numaralandÄ±rÄ±r
    highlight: tango         # Kod renklendirme temasÄ±
    theme: united            # Belge gÃ¶rÃ¼nÃ¼m temasÄ±
---
# 0. Temizlik
```{r}
if(!is.null(dev.list())) dev.off()
cat("\014")
rm(list=ls(all=TRUE)) 
```


```{r setup, include=FALSE}
# ============================================================================
# BÃ–LÃœM 0: BAÅLANGIÃ‡ AYARLARI - Bu bÃ¶lÃ¼m sadece arka planda Ã§alÄ±ÅŸÄ±r, gÃ¶rÃ¼nmez
# ============================================================================

# knitr paketinin global ayarlarÄ± yapÄ±lÄ±yor
# echo = TRUE: Kodlar Ã§Ä±ktÄ±da gÃ¶rÃ¼nsÃ¼n
# warning = FALSE: UyarÄ± mesajlarÄ± gizlensin
# message = FALSE: Paket yÃ¼klenirken Ã§Ä±kan mesajlar gizlensin
# fig.align = 'center': Grafikler ortada gÃ¶rÃ¼nsÃ¼n

knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.align = 'center')
```

# 1. GÄ°RÄ°Å: FÄ°NANSAL EKONOMETRÄ°YE HAZIRLIK

Bu ders notlarÄ±nda BÄ°ST100 endeksi Ã¼zerinden finansal ekonometrinin temel kavramlarÄ±nÄ± Ã¶ÄŸreneceÄŸiz. 
AmaÃ§larÄ±mÄ±z:

ğŸ“Š Yahoo Finance'ten canlÄ± veri Ã§ekmek
ğŸ“ Getiri hesaplamalarÄ±nÄ± Ã¶ÄŸrenmek
ğŸ“ˆ Betimsel istatistikleri yorumlamak
ğŸ” Logaritmik ve basit getiri arasÄ±ndaki iliÅŸkiyi anlamak
# 2. PAKET KURULUMU VE YÃœKLENMESÄ°

## 2.1 Paketlerin Kurulumu

```{r}
# ============================================================================
# KOD BLOÄU 1: PAKET KURULUMU
# ============================================================================

# NOT: Bu kodlarÄ± bilgisayarÄ±nÄ±zda SADECE BÄ°R KEZ Ã§alÄ±ÅŸtÄ±rmanÄ±z yeterlidir.
# EÄŸer paketler zaten yÃ¼klÃ¼yse, bu adÄ±mÄ± atlayabilirsiniz.

# install.packages() fonksiyonu: R'a yeni paketler ekler.
# TÄ±rnak iÃ§inde yazÄ±lan paket isimleri CRAN'dan indirilir.

install.packages("tidyverse")    
# tidyverse: Veri bilimi iÃ§in 8 paketin birleÅŸimi (dplyr, ggplot2, tidyr, etc.)
# dplyr: veri manipÃ¼lasyonu (filtrele, grupla, Ã¶zetle)
# ggplot2: profesyonel grafikler Ã§izmek iÃ§in

install.packages("quantmod")      
# quantmod: Quantitative Financial Modelling
# Yahoo Finance, Google Finance gibi kaynaklardan finansal veri indirir
# getSymbols() fonksiyonu bu paketin en Ã¶nemli fonksiyonudur

install.packages("psych")         
# psych: Psychological Research Tools
# describe() fonksiyonu ile detaylÄ± betimsel istatistikler hesaplar
# mean, sd, median, skew, kurtosis gibi 20+ istatistiÄŸi tek seferde verir

install.packages("PerformanceAnalytics")  
# PerformanceAnalytics: PortfÃ¶y performans ve risk analizi
# table.Stats(), table.AnnualizedReturns(), maxDrawdown() gibi fonksiyonlar iÃ§erir
# Finansal varlÄ±klarÄ±n risk Ã¶lÃ§Ã¼tlerini hesaplamak iÃ§in kullanÄ±lÄ±r

install.packages("moments")       
# moments: Ä°statistiksel moment hesaplamalarÄ±
# skewness() (Ã§arpÄ±klÄ±k), kurtosis() (basÄ±klÄ±k) hesaplar
# Jarque-Bera normallik testi iÃ§in jarque.test() fonksiyonunu iÃ§erir

install.packages("gridExtra")     
# gridExtra: Grafik dÃ¼zenleme
# grid.arrange() ile birden fazla grafiÄŸi yan yana veya alt alta dizer

install.packages("knitr")         
# knitr: R Markdown raporlama
# R kodu ile LaTeX ve metni birleÅŸtirerek profesyonel raporlar hazÄ±rlar
install.packages("conflicted")     
# conflicted: Paket Ã§akÄ±ÅŸmalarÄ±nÄ± yÃ¶netmek iÃ§in kullanÄ±lÄ±r
# AynÄ± isimli fonksiyonlar (Ã¶rneÄŸin select, filter) birden fazla pakette varsa
# R hangisini kullanacaÄŸÄ±nÄ± otomatik seÃ§er ve bu hata Ã¼retebilir.
# conflicted paketi bu durumu kontrol etmenizi saÄŸlar.
# conflict_prefer("select", "dplyr") gibi komutlarla
# hangi paketin Ã¶ncelikli olacaÄŸÄ±nÄ± siz belirlersiniz.
# Ã–zellikle tidyverse ve MASS birlikte kullanÄ±ldÄ±ÄŸÄ±nda Ã¶nerilir.
install.packages("kableExtra")     
# kableExtra: Tablo gÃ¶rselleÅŸtirme paketi
# knitr::kable() ile oluÅŸturulan tablolarÄ± daha estetik hale getirir
# HTML ve PDF Ã§Ä±ktÄ±larÄ±nda profesyonel tablo formatÄ± saÄŸlar
# kable_styling(): tabloya tema ve stil ekler
# row_spec(), column_spec(): satÄ±r ve sÃ¼tun biÃ§imlendirme yapar
# striped, hover, condensed gibi hazÄ±r tablo stilleri sunar
# Akademik rapor, tez ve makale Ã§Ä±ktÄ±larÄ± iÃ§in Ã¶nerilir

```

## 2.2 Paketlerin YÃ¼klenmesi

```{r}
# ============================================================================
# KOD BLOÄU 2: PAKETLERÄ° AKTÄ°F ETME
# ============================================================================

# library() fonksiyonu: Kurulu paketleri hafÄ±zaya yÃ¼kler.
# Her R oturumunda (session) bir kez Ã§alÄ±ÅŸtÄ±rÄ±lmalÄ±dÄ±r.

library(tidyverse)                # tidyverse paketini yÃ¼kle
# Ã‡akÄ±ÅŸma uyarÄ±sÄ±: filter() ve lag() gibi fonksiyonlar birden Ã§ok pakette var
# Bu durumda en son yÃ¼klenen paketin fonksiyonu Ã¶nceliklidir

library(quantmod)                 # quantmod paketini yÃ¼kle
# getSymbols() artÄ±k kullanÄ±ma hazÄ±r

library(psych)                    # psych paketini yÃ¼kle
# describe() fonksiyonu geldi

library(PerformanceAnalytics)     # PerformanceAnalytics paketini yÃ¼kle
# Finansal risk Ã¶lÃ§Ã¼mleri iÃ§in gerekli fonksiyonlar eklendi

library(moments)                  # moments paketini yÃ¼kle
# skewness, kurtosis, jarque.test() eklendi

library(gridExtra)                # gridExtra paketini yÃ¼kle
# grid.arrange() eklendi
```

# 3. VERÄ° Ä°NDÄ°RME: YAHOO FINANCE'DEN BÄ°ST100 Ã‡EKMEK

## 3.1 Veri Ä°ndirme ve Ä°lk Kontroller

```{r}
# ============================================================================
# BÄ°ST100 VERÄ°SÄ°NÄ° YAHOO FÄ°NANCE'TEN Ã‡EKME
# ============================================================================

bist <- getSymbols("XU100.IS", 
                   src = "yahoo", 
                   from = "2021-01-01", 
                   to = Sys.Date(),
                   auto.assign = FALSE)
colnames(bist) <- c("Open", "High", "Low", "Close", "Volume", "Adjusted")

# ----------------------------------------------------------------------------
# KOD AÃ‡IKLAMALARI:
# ----------------------------------------------------------------------------

# getSymbols()                  : quantmod paketinden finansal veri indirme fonksiyonu
#                              - Yahoo Finance, Google Finance vb. kaynaklardan veri Ã§eker
#                              - xts (zaman serisi) formatÄ±nda veri dÃ¶ndÃ¼rÃ¼r

# "XU100.IS"                   : BÄ°ST100 endeksinin Yahoo Finance'teki sembolÃ¼
#                              - XU100: BÄ°ST100 endeks kodu
#                              - .IS  : Borsa Ä°stanbul (Istanbul Stock Exchange) uzantÄ±sÄ±
#                              - NOT: Eski kod "^XU100" Ã‡ALIÅMAZ, doÄŸrusu "XU100.IS"

# src = "yahoo"                : Veri kaynaÄŸÄ± (source)
#                              - "yahoo" : Yahoo Finance (varsayÄ±lan)
#                              - "google": Google Finance (kullanÄ±m dÄ±ÅŸÄ±)
#                              - "oanda" : DÃ¶viz kurlarÄ± iÃ§in
#                              - "fred"  : ABD ekonomik verileri iÃ§in

# from = "2021-01-01"          : BaÅŸlangÄ±Ã§ tarihi
#                              - Format: YYYY-MM-DD (yÄ±l-ay-gÃ¼n)
#                              - 1 Ocak 2021'den itibaren tÃ¼m verileri getir

# to = Sys.Date()              : BitiÅŸ tarihi
#                              - Sys.Date() = bugÃ¼nÃ¼n tarihi (otomatik gÃ¼ncellenir)
#                              - Ã–rnek: 2024-01-15 gibi
#                              - ManÃ¼el tarih de verilebilir: to = "2024-12-31"

# ----------------------------------------------------------------------------
# Ã‡ALIÅTIRMA SONRASI:
# ----------------------------------------------------------------------------

# Veri baÅŸarÄ±yla indirildiÄŸinde otomatik olarak "XU100.IS" adlÄ± bir deÄŸiÅŸken oluÅŸur
# Bu deÄŸiÅŸken xts (zaman serisi) formatÄ±ndadÄ±r ve 6 sÃ¼tun iÃ§erir:

# XU100.IS.Open   : GÃ¼nlÃ¼k aÃ§Ä±lÄ±ÅŸ fiyatÄ±
# XU100.IS.High   : GÃ¼nlÃ¼k en yÃ¼ksek fiyat
# XU100.IS.Low    : GÃ¼nlÃ¼k en dÃ¼ÅŸÃ¼k fiyat
# XU100.IS.Close  : GÃ¼nlÃ¼k kapanÄ±ÅŸ fiyatÄ±
# XU100.IS.Volume : GÃ¼nlÃ¼k iÅŸlem hacmi
# XU100.IS.Adjusted : Splits ve temettÃ¼ dÃ¼zeltilmiÅŸ kapanÄ±ÅŸ

# ----------------------------------------------------------------------------
# VERÄ°YÄ° KONTROL ETME:
# ----------------------------------------------------------------------------

head(bist)    # Ä°lk 6 satÄ±rÄ± gÃ¶ster
tail(bist)    # Son 6 satÄ±rÄ± gÃ¶ster
str(bist)     # Veri yapÄ±sÄ±nÄ± gÃ¶ster
summary(bist) # Ã–zet istatistikler

# ----------------------------------------------------------------------------
# ALTERNATÄ°F KULLANIMLAR:
# ----------------------------------------------------------------------------

# FarklÄ± tarih aralÄ±ÄŸÄ±:
# getSymbols("XU100.IS", from = "2020-01-01", to = "2023-12-31")

# FarklÄ± BIST hisseleri:
# getSymbols("THYAO.IS", from = "2021-01-01", to = Sys.Date())  # THY
# getSymbols("AKBNK.IS", from = "2021-01-01", to = Sys.Date())  # Akbank
# getSymbols("GARAN.IS", from = "2021-01-01", to = Sys.Date())  # Garanti
```


## 4.1 Getiri TÃ¼rlerinin Matematiksel TanÄ±mÄ±

Finansal ekonometride iki temel getiri kavramÄ± vardÄ±r:

### 4.1.1 Basit Getiri (Simple Return)

$$
R_t = \frac{P_t - P_{t-1}}{P_{t-1}} = \frac{P_t}{P_{t-1}} - 1
$$

### 4.1.2 Logaritmik Getiri (Log Return)

$$
\begin{aligned}
r_t &= \ln\left(\frac{P_t}{P_{t-1}}\right)
     = \ln(P_t) - \ln(P_{t-1}) \\[6pt]

P_t      &:\; t \text{ zamanÄ±ndaki fiyat} \\
P_{t-1}  &:\; \text{bir Ã¶nceki dÃ¶nem fiyat} \\
\ln      &:\; \text{doÄŸal logaritma}
\end{aligned}

$$

## 4.2 R'da Getiri Hesaplama

```{r}
# ============================================================================
# KOD BLOÄU 5: GETÄ°RÄ° HESAPLAMA
# ============================================================================

# prices: fiyat vektÃ¶rÃ¼
fiyat <- bist$Close

# diff() fonksiyonu: ardÄ±ÅŸÄ±k elemanlar arasÄ±ndaki farkÄ± alÄ±r
# Ã–rnek: diff(c(10, 12, 15)) = c(2, 3)
# Yani: 12-10=2, 15-12=3

# Delt() fonksiyonu: YÃ¼zde deÄŸiÅŸim hesaplar
# (Pt - Pt-1) / Pt-1

# BASÄ°T GETÄ°RÄ°: (Pt - Pt-1) / Pt-1
bist$Basit_Getiri <- Delt(fiyat)

# LOGARÄ°TMÄ°K GETÄ°RÄ°: ln(Pt) - ln(Pt-1)
bist$Log_Getiri <- diff(log(fiyat))

# NA deÄŸerlerini kontrol et
cat("Ä°lk 5 gÃ¶zlem:\n")
head(bist[, c("Close", "Basit_Getiri", "Log_Getiri")], 5) %>% 
  round(digits = 5)

cat("\nSon 5 gÃ¶zlem:\n")
tail(bist[, c("Close", "Basit_Getiri", "Log_Getiri")], 5) %>% 
  round(digits = 5)

```
## 5.1 Teorik Ä°spat (Taylor Serisi)

Bir fonksiyonun $a$ noktasÄ± etrafÄ±ndaki Taylor aÃ§Ä±lÄ±mÄ±:

$$
\text{Bir fonksiyonun a noktasÄ± etrafÄ±ndaki Taylor aÃ§Ä±lÄ±mÄ±:} \\
f(x) \approx f(a) + f'(a)(x-a) + \frac{f''(a)}{2!}(x-a)^2 
+ \frac{f^{(3)}(a)}{3!}(x-a)^3 + \cdots
$$

Logaritmik getiri ile basit getiri arasÄ±ndaki iliÅŸkiyi gÃ¶stermek iÃ§in:

fonksiyonunun $R=0$ etrafÄ±ndaki Taylor aÃ§Ä±lÄ±mÄ±nÄ± inceleyelim.

---

### TÃ¼revler


$$
\text{Taylor Serisi}\\
\text{Bir fonksiyonun belirli bir nokta etrafÄ±ndaki Taylor serisi aÃ§Ä±lÄ±mÄ±:}\\
\begin{aligned}
f(0) &= \ln(1) = 0 \\

f'(R) &= \frac{1}{1+R} \Rightarrow f'(0) = 1 \\

f''(R) &= -\frac{1}{(1+R)^2} \Rightarrow f''(0) = -1 \\

f^{(3)}(R) &= \frac{2}{(1+R)^3} \Rightarrow f^{(3)}(0) = 2 \\[8pt]

\text{Yerine koyarsak:} \\

\ln(1+R) &= 0 + R - \frac{1}{2}R^2 + \frac{1}{3}R^3 - \frac{1}{4}R^4 + \cdots \\[6pt]

\text{DolayÄ±sÄ±yla:} \\

\ln(1+R) &= R - \frac{R^2}{2} + \frac{R^3}{3} - \frac{R^4}{4} + \cdots \\[6pt]

\text{EÄŸer } |R| < 0.1, \text{ ise} \quad 
\ln(1+R) &\approx R \\
\end{aligned} \\
\text{Yani kÃ¼Ã§Ã¼k getiriler iÃ§in logaritmik getiri yaklaÅŸÄ±k olarak basit getiriye eÅŸittir.
}
$$
```{r}
# ============================================================================
# KOD BLOÄU 6: SAYISAL Ä°SPAT
# ============================================================================

# ------------------------------------------------------------
# Ã–rnek 1: KÃ¼Ã§Ã¼k Getiri (%1)
# ------------------------------------------------------------

R_kucuk <- 0.01                   
# %1 = 0.01 (ondalÄ±k sayÄ± olarak)

r_log <- log(1 + R_kucuk)         
# ln(1 + 0.01) hesapla

# round() fonksiyonu: sayÄ±yÄ± yuvarlar
# round(x, digits = 4): x'i 4 ondalÄ±k basamaÄŸa yuvarla
# Ã–rnek: round(0.012345, 2) = 0.01

hata_mutlak <- abs(R_kucuk - r_log)  
# |0.01 - log(1.01)| mutlak fark
# abs(): mutlak deÄŸer alÄ±r

hata_yuzde <- (hata_mutlak / R_kucuk) * 100  
# YÃ¼zdesel hata = (mutlak hata / gerÃ§ek deÄŸer) * 100

# data.frame(): tablo oluÅŸturur
ispat_tablo1 <- data.frame(
  Getiri_Turu = c("Basit Getiri (R)", 
                  "Logaritmik Getiri (r)", 
                  "Mutlak Fark", 
                  "YÃ¼zdesel Hata"),
  Deger = c(R_kucuk, 
            round(r_log, 6),        # log deÄŸerini 6 basamak yuvarla
            round(hata_mutlak, 6),   # hatayÄ± 6 basamak yuvarla
            round(hata_yuzde, 4))    # yÃ¼zdeyi 4 basamak yuvarla
)

kable(ispat_tablo1, 
      caption = "Tablo 3: %1 Getiri iÃ§in KarÅŸÄ±laÅŸtÄ±rma", 
      digits = 6)

# ------------------------------------------------------------
# Ã–rnek 2: BÃ¼yÃ¼k Getiri (%20)
# ------------------------------------------------------------

R_buyuk <- 0.20                    
# %20 = 0.20

r_log_buyuk <- log(1 + R_buyuk)    
# ln(1.20) hesapla

hata_buyuk <- abs(R_buyuk - r_log_buyuk)

ispat_tablo2 <- data.frame(
  Getiri_Turu = c("Basit Getiri (R)", 
                  "Logaritmik Getiri (r)", 
                  "Mutlak Fark"),
  Deger = c(R_buyuk, 
            round(r_log_buyuk, 6), 
            round(hata_buyuk, 6))
)

kable(ispat_tablo2, 
      caption = "Tablo 4: %20 Getiri iÃ§in KarÅŸÄ±laÅŸtÄ±rma", 
      digits = 6)

# ------------------------------------------------------------
# Grafiksel GÃ¶sterim
# ------------------------------------------------------------

# seq(): dizi oluÅŸturur
# from = -0.3: -%30'dan baÅŸla
# to = 0.3: %30'a kadar
# by = 0.01: 0.01'lik adÄ±mlarla
R_values <- seq(-0.3, 0.3, by = 0.01)

# log(1+R) hesapla (her R deÄŸeri iÃ§in)
log_returns <- log(1 + R_values)

# data.frame ile grafik verisi oluÅŸtur
plot_data <- data.frame(
  R = R_values,
  LogReturn = log_returns,
  Esitlik = R_values  # 45 derece Ã§izgisi iÃ§in (y=x)
)

# ggplot: grafik Ã§izim paketi
# aes(): aesthetic - x ve y eksenlerini tanÄ±mla
ggplot(plot_data, aes(x = R)) +
  
  # geom_line(): Ã§izgi grafiÄŸi
  # aes(y = LogReturn, color = "..."): y ekseni, renk tanÄ±mÄ±
  # size: Ã§izgi kalÄ±nlÄ±ÄŸÄ±
  geom_line(aes(y = LogReturn, color = "Logaritmik Getiri"), size = 1.2) +
  
  # geom_line(): ikinci Ã§izgi (kesikli)
  # linetype = "dashed": kesikli Ã§izgi
  geom_line(aes(y = Esitlik, color = "Basit Getiri"), 
            linetype = "dashed", size = 1) +
  
  # labs(): baÅŸlÄ±k ve etiketler
  labs(title = "Grafik 1: Logaritmik ve Basit Getiri KarÅŸÄ±laÅŸtÄ±rmasÄ±",
       subtitle = "KÃ¼Ã§Ã¼k getirilerde iki eÄŸri Ã§akÄ±ÅŸÄ±r",
       x = "Basit Getiri (R)",
       y = "Getiri DeÄŸeri",
       color = "Getiri TÃ¼rÃ¼:") +
  
  # theme_minimal(): minimalist tema
  theme_minimal() +
  
  # scale_color_manual(): renkleri manuel ayarla
  scale_color_manual(values = c("Logaritmik Getiri" = "darkblue", 
                                 "Basit Getiri" = "darkred")) +
  
  # annotate(): grafik Ã¼zerine not ekle
  annotate("text", x = 0.15, y = 0.13, 
           label = "KÃ¼Ã§Ã¼k R'lerde fark azalÄ±r\n(Ã§izgiler Ã§akÄ±ÅŸÄ±r)", 
           size = 4, color = "gray30")
```


```{r}
# ============================================================================
# KOD BLOÄU 7: BETÄ°MSEL Ä°STATÄ°STÄ°KLER
# ============================================================================

# ------------------------------------------------------------
# Veriyi HazÄ±rlama
# ------------------------------------------------------------

# filter(!is.na(...)): NA (boÅŸ) olmayan satÄ±rlarÄ± filtrele
# !is.na(): NA deÄŸilse TRUE dÃ¶ner
# is.na(): NA ise TRUE dÃ¶ner
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
bist <- as.data.frame(bist)
returns_data <- bist %>%
  filter(!is.na(Basit_Getiri)) %>%     # NA'larÄ± Ã§Ä±kar
  select(Basit_Getiri, Log_Getiri)      # sadece getiri sÃ¼tunlarÄ±nÄ± seÃ§

# ------------------------------------------------------------
# psych::describe() KullanÄ±mÄ±
# ------------------------------------------------------------

# describe() fonksiyonun parametreleri:
# - interp = FALSE: aralÄ±k tahmini yapma
# - skew = TRUE: Ã§arpÄ±klÄ±k hesapla
# - ranges = TRUE: min-max deÄŸerlerini gÃ¶ster
# - quant = c(0.25, 0.75): 1. ve 3. Ã§eyreklik
# - IQR = TRUE: Ã§eyrekler arasÄ± aÃ§Ä±klÄ±k
# - fast = FALSE: tÃ¼m istatistikleri hesapla

desc_stats <- psych::describe(returns_data, 
                              interp = FALSE,
                              skew = TRUE,
                              ranges = TRUE,
                              quant = c(0.25, 0.75),
                              IQR = TRUE,
                              fast = FALSE)

# ------------------------------------------------------------
# Ä°statistiklerin AnlamlarÄ±:
# ------------------------------------------------------------
# n        : gÃ¶zlem sayÄ±sÄ± (geÃ§erli veri sayÄ±sÄ±)
# mean     : aritmetik ortalama (toplam/gÃ¶zlem sayÄ±sÄ±)
# sd       : standart sapma (sqrt(varyans)) - risk Ã¶lÃ§Ã¼tÃ¼
# median   : ortanca (sÄ±ralanmÄ±ÅŸ verinin ortasÄ±ndaki deÄŸer)
# min      : minimum deÄŸer (en dÃ¼ÅŸÃ¼k getiri)
# max      : maksimum deÄŸer (en yÃ¼ksek getiri)
# range    : max - min (deÄŸiÅŸim aralÄ±ÄŸÄ±)
# skew     : Ã§arpÄ±klÄ±k (simetriden sapma)
#           = 0: simetrik, >0: saÄŸa Ã§arpÄ±k, <0: sola Ã§arpÄ±k
# kurtosis : basÄ±klÄ±k (uÃ§ deÄŸer yoÄŸunluÄŸu)
#           = 3: normal, >3: sivri (kalÄ±n kuyruk), <3: basÄ±k
# se       : standart hata (sd/sqrt(n))

desc_table <- desc_stats %>%
  as.data.frame() %>%
  select(vars, n, mean, sd, median, min, max, range, skew, kurtosis, se)

kable(desc_table, 
      caption = "Tablo 5: BÄ°ST100 Getirileri Betimsel Ä°statistikleri", 
      digits = 4)
# digits = 4: tÃ¼m sayÄ±larÄ± 4 ondalÄ±k basamakla gÃ¶ster
print(desc_stats)
```

## 6.2 Normallik Testi (Jarque-Bera)

```{r}
# ============================================================================
# KOD BLOÄU 8: JARQUE-BERA NORMALLÄ°K TESTÄ°
# ============================================================================

# ------------------------------------------------------------
# Jarque-Bera Testi HesaplamasÄ±
# ------------------------------------------------------------

# jarque.test(): Jarque-Bera normallik testi yapar
# Hipotezler:
# H0: Veri normal daÄŸÄ±lÄ±mdan gelir
# H1: Veri normal daÄŸÄ±lÄ±mdan gelmez (red)
# Test istatistiÄŸi: JB = n/6 * (S^2 + (K-3)^2/4)
# n: gÃ¶zlem sayÄ±sÄ±, S: Ã§arpÄ±klÄ±k, K: basÄ±klÄ±k

jarque_bera_basit <- jarque.test(returns_data$Basit_Getiri)
jarque_bera_log <- jarque.test(returns_data$Log_Getiri)

# ------------------------------------------------------------
# SonuÃ§larÄ± DÃ¼zenleme
# ------------------------------------------------------------

# $ iÅŸareti: listeden eleman Ã§ekme
# statistic: test istatistiÄŸi deÄŸeri
# p.value: p-deÄŸeri (anlamlÄ±lÄ±k dÃ¼zeyi)

normallik_sonuc <- data.frame(
  Getiri_Turu = c("Basit Getiri", "Logaritmik Getiri"),
  JB_Istatistigi = c(round(jarque_bera_basit$statistic, 4), 
                     round(jarque_bera_log$statistic, 4)),
  p_degeri = c(round(jarque_bera_basit$p.value, 6), 
               round(jarque_bera_log$p.value, 6)),
  Karar = c(ifelse(jarque_bera_basit$p.value < 0.05, 
                   "Normal DeÄŸil (RED)", 
                   "Normal (KABUL)"),
            ifelse(jarque_bera_log$p.value < 0.05, 
                   "Normal DeÄŸil (RED)", 
                   "Normal (KABUL)"))
)

# ifelse(test, doÄŸruysa, yanlÄ±ÅŸsa): koÅŸullu iÅŸlem
# p < 0.05 ise %95 gÃ¼venle normal deÄŸil deriz

kable(normallik_sonuc, 
      caption = "Tablo 6: Jarque-Bera Normallik Testi SonuÃ§larÄ±", 
      digits = 4) %>% 
  kable_styling(position = "center", full_width = FALSE)
```






```{r}
knitr::kable(desc_table, digits = 4) %>%
  kable_styling(position = "center", full_width = FALSE)
```












